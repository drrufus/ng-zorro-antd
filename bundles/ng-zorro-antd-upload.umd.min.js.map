{"version":3,"sources":["../../node_modules/tslib/tslib.es6.js","ng://ng-zorro-antd/upload/nz-upload-btn.component.ts","ng://ng-zorro-antd/upload/nz-upload-btn.component.html","ng://ng-zorro-antd/upload/nz-upload-list.component.ts","ng://ng-zorro-antd/upload/nz-upload-list.component.html","ng://ng-zorro-antd/upload/nz-upload.component.html","ng://ng-zorro-antd/upload/nz-upload.component.ts","ng://ng-zorro-antd/upload/nz-upload.module.ts"],"names":["__assign","Object","assign","t","s","i","n","arguments","length","p","prototype","hasOwnProperty","call","apply","this","__decorate","decorators","target","key","desc","d","c","r","getOwnPropertyDescriptor","Reflect","decorate","defineProperty","__metadata","metadataKey","metadataValue","metadata","__values","o","m","Symbol","iterator","next","value","done","__read","e","ar","push","error","NzUploadBtnComponent","http","el","updateHostClassService","reqs","inited","destroy","classes","prefixCls","Error","onClick","options","disabled","openFileDialogOnClick","file","nativeElement","click","onKeyDown","keyCode","ENTER","onFileDrop","_this","type","preventDefault","directory","traverseFileTree","dataTransfer","items","files","Array","slice","filter","attrAccept","accept","uploadFiles","onChange","hie","_traverseFileTree","item","path","isFile","isDirectory","createReader","readEntries","entries","entries_1","entries_1_1","entrieItem","name","_b","_c","webkitGetAsEntry","acceptedFiles","acceptedFilesArray","isArray","split","fileName_1","mimeType_1","baseMimeType_1","replace","some","validType","trim","charAt","toLowerCase","indexOf","test","attachUid","uid","Math","random","toString","substring","fileList","filters$","of","filters","forEach","f","pipe","switchMap","list","fnRes","fn","Observable","subscribe","upload","warn","beforeUpload","post","before","processedFile","processedFileType","opt","data","headers","args","action","withCredentials","onProgress","undefined","onSuccess","ret","xhr","clean","onError","req$","customRequest","Subscription","onStart","formData","FormData","append","keys","map","req","HttpRequest","reportProgress","HttpHeaders","request","event","HttpEventType","UploadProgress","total","percent","loaded","HttpResponse","body","err","abort","unsubscribe","setClassMap","classMap","_a","updateHostClass","ngOnInit","ngOnChanges","ngOnDestroy","core","ɵɵdirectiveInject","HttpClient","ElementRef","core$1","NzUpdateHostClassService","ɵɵNgOnChangesFeature","attrs","_c1","ngContentSelectors","_c2","decls","vars","consts","template","rf","ctx","i0.ɵɵelementStart","i0.ɵɵlistener","$event","i0.ɵɵelementEnd","i0.ɵɵprojection","i0.ɵɵproperty","i0.ɵɵattribute","NzUploadListComponent_div_0_ng_template_1_ng_container_0_div_1_Template","i0.ɵɵtext","i0.ɵɵadvance","i0.ɵɵtextInterpolate1","i0.ɵɵelementContainerStart","i0.ɵɵtemplate","i0.ɵɵelementContainerEnd","_r1877","i0.ɵɵelement","_r1879","_r1881","_r1883","i0.ɵɵpropertyInterpolate","i0.ɵɵtextInterpolate","_r1897","file_r1865","url","thumbUrl","ɵɵpureFunction0","_c0$1","i0.ɵɵclassMapInterpolate1","_r1873","NzUploadListComponent","cdr","platform","imageTypes","locale","listType","_items","linkProps","JSON","parse","extname","temp","filenameWithoutSuffix","exec","isImageUrl","extension","previewFile","callback","reader","FileReader","onloadend","result","readAsDataURL","genThumb","isBrowser","win","window","showPic","document","File","originFileObj","previewDataUrl","detectChanges","showPreview","icons","showPreviewIcon","hidePreviewIconInNonImage","handlePreview","onPreview","handleRemove","onRemove","ChangeDetectorRef","Platform","trigger","transition","style","height","width","opacity","animate","changeDetection","i0.ɵɵstyleProp","ctx_r1929","nzListType","nzFileList","_c2$1","nzShowUploadList","nzPreview","ɵɵrestoreView","_r1946","ɵɵnextContext","fileDrop","_c3","_r1937","NzUploadComponent","i18n","nzType","nzLimit","nzSize","nzDirectory","nzOpenFileDialogOnClick","nzFilter","nzDisabled","nzMultiple","nzName","_showUploadList","nzShowButton","nzWithCredentials","nzChange","EventEmitter","nzFileListChange","targetItem","fileToObject","status","concat","emit","detectChangesList","getFileItem","res","response","message","genErr","uploadComp","nzRemove","removeFileItem","classList","toBoolean","zipOptions","showRemoveIcon","findIndex","w","size","nzFileType","types_1","_btnOptions","nzAccept","nzAction","nzBeforeUpload","nzCustomRequest","nzData","nzHeaders","multiple","lastModified","lastModifiedDate","filename","statusText","uploadError","dragState","listComp","subCls","__spread","i18n$","localeChange","getLocaleData","changes","NzI18nService","selectors","viewQuery","_r1935","InputNumber","InputBoolean","NzUploadModule","imports","common","CommonModule","forms","FormsModule","PlatformModule","tooltip","NzToolTipModule","progress","NzProgressModule","NzI18nModule","icon","NzIconModule","declarations","exports"],"mappings":"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","sourcesContent":["/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation. All rights reserved.\r\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\nthis file except in compliance with the License. You may obtain a copy of the\r\nLicense at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\nMERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\nSee the Apache Version 2.0 License for specific language governing permissions\r\nand limitations under the License.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport function __exportStar(m, exports) {\r\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\r\n}\r\n\r\nexport function __values(o) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator], i = 0;\r\n    if (m) return m.call(o);\r\n    return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\nexport function __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n};\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];\r\n    result.default = mod;\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n","/**\r\n * @license\r\n * Copyright Alibaba.com All Rights Reserved.\r\n *\r\n * Use of this source code is governed by an MIT-style license that can be\r\n * found in the LICENSE file at https://github.com/NG-ZORRO/ng-zorro-antd/blob/master/LICENSE\r\n */\r\n\r\nimport { ENTER } from '@angular/cdk/keycodes';\r\nimport { HttpClient, HttpEvent, HttpEventType, HttpHeaders, HttpRequest, HttpResponse } from '@angular/common/http';\r\nimport {\r\n  Component,\r\n  ElementRef,\r\n  HostListener,\r\n  Input,\r\n  OnChanges,\r\n  OnDestroy,\r\n  OnInit,\r\n  Optional,\r\n  ViewChild,\r\n  ViewEncapsulation\r\n} from '@angular/core';\r\nimport { Observable, of, Subscription } from 'rxjs';\r\nimport { switchMap } from 'rxjs/operators';\r\n\r\nimport { NzUpdateHostClassService, warn } from 'ng-zorro-antd/core';\r\n\r\nimport { UploadFile, UploadXHRArgs, ZipButtonOptions } from './interface';\r\n\r\n@Component({\r\n  selector: '[nz-upload-btn]',\r\n  exportAs: 'nzUploadBtn',\r\n  templateUrl: './nz-upload-btn.component.html',\r\n  host: {\r\n    '[attr.tabindex]': '\"0\"',\r\n    '[attr.role]': '\"button\"'\r\n  },\r\n  providers: [NzUpdateHostClassService],\r\n  preserveWhitespaces: false,\r\n  encapsulation: ViewEncapsulation.None\r\n})\r\nexport class NzUploadBtnComponent implements OnInit, OnChanges, OnDestroy {\r\n  reqs: { [key: string]: Subscription } = {};\r\n  private inited = false;\r\n  private destroy = false;\r\n\r\n  @ViewChild('file', { static: false }) file: ElementRef;\r\n\r\n  // #region fields\r\n  @Input() classes: {} = {};\r\n  @Input() options: ZipButtonOptions;\r\n\r\n  // #endregion\r\n\r\n  @HostListener('click')\r\n  onClick(): void {\r\n    if (this.options.disabled || !this.options.openFileDialogOnClick) {\r\n      return;\r\n    }\r\n    (this.file.nativeElement as HTMLInputElement).click();\r\n  }\r\n\r\n  @HostListener('keydown', ['$event'])\r\n  onKeyDown(e: KeyboardEvent): void {\r\n    if (this.options.disabled) {\r\n      return;\r\n    }\r\n    if (e.key === 'Enter' || e.keyCode === ENTER) {\r\n      this.onClick();\r\n    }\r\n  }\r\n\r\n  @HostListener('drop', ['$event'])\r\n  @HostListener('dragover', ['$event'])\r\n  // skip safari bug\r\n  // tslint:disable-next-line:no-any\r\n  onFileDrop(e: any): void {\r\n    if (this.options.disabled || e.type === 'dragover') {\r\n      e.preventDefault();\r\n      return;\r\n    }\r\n    if (this.options.directory) {\r\n      this.traverseFileTree(e.dataTransfer!.items);\r\n    } else {\r\n      const files: File[] = Array.prototype.slice\r\n        .call(e.dataTransfer!.files)\r\n        .filter((file: File) => this.attrAccept(file, this.options.accept));\r\n      if (files.length) {\r\n        this.uploadFiles(files);\r\n      }\r\n    }\r\n\r\n    e.preventDefault();\r\n  }\r\n\r\n  onChange(e: Event): void {\r\n    if (this.options.disabled) {\r\n      return;\r\n    }\r\n    const hie = e.target as HTMLInputElement;\r\n    this.uploadFiles(hie.files!);\r\n    hie.value = '';\r\n  }\r\n\r\n  private traverseFileTree(files: DataTransferItemList): void {\r\n    // tslint:disable-next-line:no-any\r\n    const _traverseFileTree = (item: any, path: string) => {\r\n      if (item.isFile) {\r\n        item.file((file: File) => {\r\n          if (this.attrAccept(file, this.options.accept)) {\r\n            this.uploadFiles([file]);\r\n          }\r\n        });\r\n      } else if (item.isDirectory) {\r\n        const dirReader = item.createReader();\r\n\r\n        // tslint:disable-next-line:no-any\r\n        dirReader.readEntries((entries: any) => {\r\n          for (const entrieItem of entries) {\r\n            _traverseFileTree(entrieItem, `${path}${item.name}/`);\r\n          }\r\n        });\r\n      }\r\n    };\r\n    // tslint:disable-next-line:no-any\r\n    for (const file of files as any) {\r\n      _traverseFileTree(file.webkitGetAsEntry(), '');\r\n    }\r\n  }\r\n\r\n  private attrAccept(file: File, acceptedFiles?: string | string[]): boolean {\r\n    if (file && acceptedFiles) {\r\n      const acceptedFilesArray = Array.isArray(acceptedFiles) ? acceptedFiles : acceptedFiles.split(',');\r\n      const fileName = '' + file.name;\r\n      const mimeType = '' + file.type;\r\n      const baseMimeType = mimeType.replace(/\\/.*$/, '');\r\n\r\n      return acceptedFilesArray.some(type => {\r\n        const validType = type.trim();\r\n        if (validType.charAt(0) === '.') {\r\n          return (\r\n            fileName.toLowerCase().indexOf(validType.toLowerCase(), fileName.toLowerCase().length - validType.toLowerCase().length) !== -1\r\n          );\r\n        } else if (/\\/\\*$/.test(validType)) {\r\n          // This is something like a image/* mime type\r\n          return baseMimeType === validType.replace(/\\/.*$/, '');\r\n        }\r\n        return mimeType === validType;\r\n      });\r\n    }\r\n    return true;\r\n  }\r\n\r\n  private attachUid(file: UploadFile): UploadFile {\r\n    if (!file.uid) {\r\n      file.uid = Math.random()\r\n        .toString(36)\r\n        .substring(2);\r\n    }\r\n    return file;\r\n  }\r\n\r\n  uploadFiles(fileList: FileList | File[]): void {\r\n    let filters$: Observable<UploadFile[]> = of(Array.prototype.slice.call(fileList));\r\n    if (this.options.filters) {\r\n      this.options.filters.forEach(f => {\r\n        filters$ = filters$.pipe(\r\n          switchMap(list => {\r\n            const fnRes = f.fn(list);\r\n            return fnRes instanceof Observable ? fnRes : of(fnRes);\r\n          })\r\n        );\r\n      });\r\n    }\r\n    filters$.subscribe(\r\n      list => {\r\n        list.forEach((file: UploadFile) => {\r\n          this.attachUid(file);\r\n          this.upload(file, list);\r\n        });\r\n      },\r\n      e => {\r\n        warn(`Unhandled upload filter error`, e);\r\n      }\r\n    );\r\n  }\r\n\r\n  private upload(file: UploadFile, fileList: UploadFile[]): void {\r\n    if (!this.options.beforeUpload) {\r\n      return this.post(file);\r\n    }\r\n    const before = this.options.beforeUpload(file, fileList);\r\n    if (before instanceof Observable) {\r\n      before.subscribe(\r\n        (processedFile: UploadFile) => {\r\n          const processedFileType = Object.prototype.toString.call(processedFile);\r\n          if (processedFileType === '[object File]' || processedFileType === '[object Blob]') {\r\n            this.attachUid(processedFile);\r\n            this.post(processedFile);\r\n          } else if (typeof processedFile === 'boolean' && processedFile !== false) {\r\n            this.post(file);\r\n          }\r\n        },\r\n        e => {\r\n          warn(`Unhandled upload beforeUpload error`, e);\r\n        }\r\n      );\r\n    } else if (before !== false) {\r\n      return this.post(file);\r\n    }\r\n  }\r\n\r\n  private post(file: UploadFile): void {\r\n    if (this.destroy) {\r\n      return;\r\n    }\r\n    const opt = this.options;\r\n    const { uid } = file;\r\n    let { data, headers } = opt;\r\n    if (typeof data === 'function') {\r\n      data = (data as (file: UploadFile) => {})(file);\r\n    }\r\n    if (typeof headers === 'function') {\r\n      headers = (headers as (file: UploadFile) => {})(file);\r\n    }\r\n    const args: UploadXHRArgs = {\r\n      action: opt.action,\r\n      name: opt.name,\r\n      headers,\r\n      file,\r\n      data,\r\n      withCredentials: opt.withCredentials,\r\n      onProgress: opt.onProgress\r\n        ? e => {\r\n            opt.onProgress!(e, file);\r\n          }\r\n        : undefined,\r\n      onSuccess: (ret, xhr) => {\r\n        this.clean(uid);\r\n        opt.onSuccess!(ret, file, xhr);\r\n      },\r\n      onError: xhr => {\r\n        this.clean(uid);\r\n        opt.onError!(xhr, file);\r\n      }\r\n    };\r\n    const req$ = (opt.customRequest || this.xhr).call(this, args);\r\n    if (!(req$ instanceof Subscription)) {\r\n      warn(`Must return Subscription type in '[nzCustomRequest]' property`);\r\n    }\r\n    this.reqs[uid] = req$;\r\n    opt.onStart!(file);\r\n  }\r\n\r\n  private xhr(args: UploadXHRArgs): Subscription {\r\n    const formData = new FormData();\r\n    // tslint:disable-next-line:no-any\r\n    formData.append(args.name!, args.file as any);\r\n    if (args.data) {\r\n      Object.keys(args.data).map(key => {\r\n        formData.append(key, args.data![key]);\r\n      });\r\n    }\r\n    if (!args.headers) {\r\n      args.headers = {};\r\n    }\r\n    if (args.headers['X-Requested-With'] !== null) {\r\n      args.headers['X-Requested-With'] = `XMLHttpRequest`;\r\n    } else {\r\n      delete args.headers['X-Requested-With'];\r\n    }\r\n    const req = new HttpRequest('POST', args.action!, formData, {\r\n      reportProgress: true,\r\n      withCredentials: args.withCredentials,\r\n      headers: new HttpHeaders(args.headers)\r\n    });\r\n    return this.http.request(req).subscribe(\r\n      // tslint:disable-next-line no-any\r\n      (event: HttpEvent<any>) => {\r\n        if (event.type === HttpEventType.UploadProgress) {\r\n          if (event.total! > 0) {\r\n            // tslint:disable-next-line:no-any\r\n            (event as any).percent = (event.loaded / event.total!) * 100;\r\n          }\r\n          args.onProgress!(event, args.file);\r\n        } else if (event instanceof HttpResponse) {\r\n          args.onSuccess!(event.body, args.file, event);\r\n        }\r\n      },\r\n      err => {\r\n        this.abort(args.file);\r\n        args.onError!(err, args.file);\r\n      }\r\n    );\r\n  }\r\n\r\n  private clean(uid: string): void {\r\n    const req$ = this.reqs[uid];\r\n    if (req$ instanceof Subscription) {\r\n      req$.unsubscribe();\r\n    }\r\n    delete this.reqs[uid];\r\n  }\r\n\r\n  abort(file?: UploadFile): void {\r\n    if (file) {\r\n      this.clean(file && file.uid);\r\n    } else {\r\n      Object.keys(this.reqs).forEach(uid => this.clean(uid));\r\n    }\r\n  }\r\n\r\n  // #region styles\r\n\r\n  private prefixCls = 'ant-upload';\r\n\r\n  private setClassMap(): void {\r\n    const classMap = {\r\n      [this.prefixCls]: true,\r\n      [`${this.prefixCls}-disabled`]: this.options.disabled,\r\n      ...this.classes\r\n    };\r\n    this.updateHostClassService.updateHostClass(this.el.nativeElement, classMap);\r\n  }\r\n\r\n  // #endregion\r\n\r\n  constructor(@Optional() private http: HttpClient, private el: ElementRef, private updateHostClassService: NzUpdateHostClassService) {\r\n    if (!http) {\r\n      throw new Error(`Not found 'HttpClient', You can import 'HttpClientModule' in your root module.`);\r\n    }\r\n  }\r\n\r\n  ngOnInit(): void {\r\n    this.inited = true;\r\n    this.setClassMap();\r\n  }\r\n\r\n  ngOnChanges(): void {\r\n    if (this.inited) {\r\n      this.setClassMap();\r\n    }\r\n  }\r\n\r\n  ngOnDestroy(): void {\r\n    this.destroy = true;\r\n    this.abort();\r\n  }\r\n}\r\n","<input\r\n  type=\"file\"\r\n  #file\r\n  (change)=\"onChange($event)\"\r\n  [attr.accept]=\"options.accept\"\r\n  [attr.directory]=\"options.directory ? 'directory' : null\"\r\n  [attr.webkitdirectory]=\"options.directory ? 'webkitdirectory' : null\"\r\n  [multiple]=\"options.multiple\"\r\n  style=\"display: none;\"\r\n/>\r\n<ng-content></ng-content>\r\n","/**\r\n * @license\r\n * Copyright Alibaba.com All Rights Reserved.\r\n *\r\n * Use of this source code is governed by an MIT-style license that can be\r\n * found in the LICENSE file at https://github.com/NG-ZORRO/ng-zorro-antd/blob/master/LICENSE\r\n */\r\n\r\nimport { animate, style, transition, trigger } from '@angular/animations';\r\nimport { Platform } from '@angular/cdk/platform';\r\nimport { ChangeDetectionStrategy, ChangeDetectorRef, Component, ElementRef, Input, OnChanges, ViewEncapsulation } from '@angular/core';\r\n\r\nimport { NzUpdateHostClassService } from 'ng-zorro-antd/core';\r\n\r\nimport { ShowUploadListInterface, UploadFile, UploadListType } from './interface';\r\n\r\n@Component({\r\n  selector: 'nz-upload-list',\r\n  exportAs: 'nzUploadList',\r\n  templateUrl: './nz-upload-list.component.html',\r\n  providers: [NzUpdateHostClassService],\r\n  animations: [\r\n    trigger('itemState', [\r\n      transition(':enter', [style({ height: '0', width: '0', opacity: 0 }), animate(150, style({ height: '*', width: '*', opacity: 1 }))]),\r\n      transition(':leave', [animate(150, style({ height: '0', width: '0', opacity: 0 }))])\r\n    ])\r\n  ],\r\n  preserveWhitespaces: false,\r\n  encapsulation: ViewEncapsulation.None,\r\n  changeDetection: ChangeDetectionStrategy.OnPush\r\n})\r\nexport class NzUploadListComponent implements OnChanges {\r\n  private imageTypes = ['image', 'webp', 'png', 'svg', 'gif', 'jpg', 'jpeg', 'bmp'];\r\n  private _items: UploadFile[];\r\n\r\n  get showPic(): boolean {\r\n    return this.listType === 'picture' || this.listType === 'picture-card';\r\n  }\r\n\r\n  // #region fields\r\n\r\n  // tslint:disable-next-line:no-any\r\n  @Input() locale: any = {};\r\n  @Input() listType: UploadListType;\r\n  @Input()\r\n  set items(list: UploadFile[]) {\r\n    list.forEach(file => {\r\n      file.linkProps = typeof file.linkProps === 'string' ? JSON.parse(file.linkProps) : file.linkProps;\r\n    });\r\n    this._items = list;\r\n  }\r\n  get items(): UploadFile[] {\r\n    return this._items;\r\n  }\r\n  @Input() icons: ShowUploadListInterface;\r\n  @Input() onPreview: (file: UploadFile) => void;\r\n  @Input() onRemove: (file: UploadFile) => void;\r\n\r\n  // #endregion\r\n\r\n  // #region styles\r\n\r\n  private prefixCls = 'ant-upload-list';\r\n\r\n  private setClassMap(): void {\r\n    const classMap = {\r\n      [this.prefixCls]: true,\r\n      [`${this.prefixCls}-${this.listType}`]: true\r\n    };\r\n    this.updateHostClassService.updateHostClass(this.el.nativeElement, classMap);\r\n  }\r\n\r\n  // #endregion\r\n\r\n  // #region render\r\n\r\n  private extname(url: string): string {\r\n    const temp = url.split('/');\r\n    const filename = temp[temp.length - 1];\r\n    const filenameWithoutSuffix = filename.split(/#|\\?/)[0];\r\n    return (/\\.[^./\\\\]*$/.exec(filenameWithoutSuffix) || [''])[0];\r\n  }\r\n\r\n  isImageUrl(file: UploadFile): boolean {\r\n    if (~this.imageTypes.indexOf(file.type)) {\r\n      return true;\r\n    }\r\n    const url: string = (file.thumbUrl || file.url || '') as string;\r\n    if (!url) {\r\n      return false;\r\n    }\r\n    const extension = this.extname(url);\r\n    if (/^data:image\\//.test(url) || /(webp|svg|png|gif|jpg|jpeg|bmp)$/i.test(extension)) {\r\n      return true;\r\n    } else if (/^data:/.test(url)) {\r\n      // other file types of base64\r\n      return false;\r\n    } else if (extension) {\r\n      // other file types which have extension\r\n      return false;\r\n    }\r\n    return true;\r\n  }\r\n\r\n  private previewFile(file: File | Blob, callback: (dataUrl: string) => void): void {\r\n    if (file.type && this.imageTypes.indexOf(file.type) === -1) {\r\n      callback('');\r\n    }\r\n    const reader = new FileReader();\r\n    // https://developer.mozilla.org/en-US/docs/Web/API/FileReader/readAsDataURL\r\n    reader.onloadend = () => callback(reader.result as string);\r\n    reader.readAsDataURL(file);\r\n  }\r\n\r\n  private genThumb(): void {\r\n    if (!this.platform.isBrowser) {\r\n      return;\r\n    }\r\n    // tslint:disable-next-line:no-any\r\n    const win = window as any;\r\n    if (!this.showPic || typeof document === 'undefined' || typeof win === 'undefined' || !win.FileReader || !win.File) {\r\n      return;\r\n    }\r\n    this.items\r\n      .filter(file => file.originFileObj instanceof File && file.thumbUrl === undefined)\r\n      .forEach(file => {\r\n        file.thumbUrl = '';\r\n        this.previewFile(file.originFileObj!, (previewDataUrl: string) => {\r\n          file.thumbUrl = previewDataUrl;\r\n          this.detectChanges();\r\n        });\r\n      });\r\n  }\r\n\r\n  showPreview(file: UploadFile): boolean {\r\n    const { showPreviewIcon, hidePreviewIconInNonImage } = this.icons;\r\n    if (!showPreviewIcon) {\r\n      return false;\r\n    }\r\n    return this.isImageUrl(file) ? true : !hidePreviewIconInNonImage;\r\n  }\r\n\r\n  handlePreview(file: UploadFile, e: Event): void {\r\n    if (!this.onPreview) {\r\n      return;\r\n    }\r\n\r\n    e.preventDefault();\r\n    return this.onPreview(file);\r\n  }\r\n\r\n  handleRemove(file: UploadFile, e: Event): void {\r\n    e.preventDefault();\r\n    if (this.onRemove) {\r\n      this.onRemove(file);\r\n    }\r\n    return;\r\n  }\r\n\r\n  // #endregion\r\n\r\n  constructor(\r\n    private el: ElementRef,\r\n    private cdr: ChangeDetectorRef,\r\n    private updateHostClassService: NzUpdateHostClassService,\r\n    private platform: Platform\r\n  ) {}\r\n\r\n  detectChanges(): void {\r\n    this.cdr.detectChanges();\r\n  }\r\n\r\n  ngOnChanges(): void {\r\n    this.setClassMap();\r\n    this.genThumb();\r\n  }\r\n}\r\n","<div\r\n  *ngFor=\"let file of items\"\r\n  class=\"ant-upload-list-item ant-upload-list-item-{{ file.status }}\"\r\n  @itemState\r\n>\r\n  <ng-template #icon>\r\n    <ng-container *ngIf=\"showPic; else noPicTpl\">\r\n      <div\r\n        *ngIf=\"listType === 'picture-card' && file.status === 'uploading'; else thumbUrlCheck\"\r\n        class=\"ant-upload-list-item-uploading-text\"\r\n      >\r\n        {{ locale.uploading }}\r\n      </div>\r\n    </ng-container>\r\n    <ng-template #thumbUrlCheck>\r\n      <i\r\n        *ngIf=\"!file.thumbUrl && !file.url; else thumbTpl\"\r\n        class=\"ant-upload-list-item-thumbnail\"\r\n        nz-icon\r\n        nzType=\"picture\"\r\n        nzTheme=\"twotone\"\r\n      ></i>\r\n    </ng-template>\r\n    <ng-template #thumbTpl>\r\n      <a\r\n        class=\"ant-upload-list-item-thumbnail\"\r\n        target=\"_blank\"\r\n        rel=\"noopener noreferrer\"\r\n        [href]=\"file.thumbUrl || file.url\"\r\n        (click)=\"handlePreview(file, $event)\"\r\n      >\r\n        <img\r\n          *ngIf=\"isImageUrl(file); else noThumbTpl\"\r\n          [src]=\"file.thumbUrl || file.url\"\r\n          [attr.alt]=\"file.name\"\r\n        />\r\n      </a>\r\n    </ng-template>\r\n    <ng-template #noThumbTpl\r\n      ><i class=\"ant-upload-list-item-icon\" nz-icon nzType=\"file\" nzTheme=\"twotone\"></i\r\n    ></ng-template>\r\n    <ng-template #noPicTpl\r\n      ><i nz-icon [nzType]=\"file.status === 'uploading' ? 'loading' : 'paper-clip'\"></i\r\n    ></ng-template>\r\n  </ng-template>\r\n  <ng-template #preview>\r\n    <ng-container *ngIf=\"file.url; else prevText\">\r\n      <a\r\n        [href]=\"file.thumbUrl || file.url\"\r\n        target=\"_blank\"\r\n        rel=\"noopener noreferrer\"\r\n        [attr.download]=\"file.linkProps && file.linkProps.download\"\r\n        (click)=\"handlePreview(file, $event)\"\r\n        class=\"ant-upload-list-item-name\"\r\n        title=\"{{ file.name }}\"\r\n        >{{ file.name }}</a\r\n      >\r\n    </ng-container>\r\n    <ng-template #prevText>\r\n      <span\r\n        (click)=\"handlePreview(file, $event)\"\r\n        class=\"ant-upload-list-item-name\"\r\n        title=\"{{ file.name }}\"\r\n        >{{ file.name }}</span\r\n      >\r\n    </ng-template>\r\n  </ng-template>\r\n  <div class=\"ant-upload-list-item-info\">\r\n    <span *ngIf=\"file.status === 'error'\" nz-tooltip [nzTitle]=\"file.message\">\r\n      <ng-template [ngTemplateOutlet]=\"icon\"></ng-template>\r\n      <ng-template [ngTemplateOutlet]=\"preview\"></ng-template>\r\n    </span>\r\n    <span *ngIf=\"file.status !== 'error'\">\r\n      <ng-template [ngTemplateOutlet]=\"icon\"></ng-template>\r\n      <ng-template [ngTemplateOutlet]=\"preview\"></ng-template>\r\n    </span>\r\n  </div>\r\n  <ng-container *ngIf=\"listType === 'picture-card' && file.status !== 'uploading'; else close\">\r\n    <span class=\"ant-upload-list-item-actions\">\r\n      <a\r\n        *ngIf=\"showPreview(file)\"\r\n        [href]=\"file.thumbUrl || file.url\"\r\n        target=\"_blank\"\r\n        rel=\"noopener noreferrer\"\r\n        title=\"{{ locale.previewFile }}\"\r\n        [ngStyle]=\"!(file.url || file.thumbUrl) && { opacity: 0.5, 'pointer-events': 'none' }\"\r\n        (click)=\"handlePreview(file, $event)\"\r\n      >\r\n        <i nz-icon nzType=\"eye-o\"></i>\r\n      </a>\r\n      <i\r\n        *ngIf=\"icons.showRemoveIcon\"\r\n        (click)=\"handleRemove(file, $event)\"\r\n        nz-icon\r\n        nzType=\"delete\"\r\n        title=\"{{ locale.removeFile }}\"\r\n      ></i>\r\n    </span>\r\n  </ng-container>\r\n  <ng-template #close>\r\n    <i\r\n      *ngIf=\"icons.showRemoveIcon\"\r\n      (click)=\"handleRemove(file, $event)\"\r\n      nz-icon\r\n      nzType=\"close\"\r\n      title=\"{{ locale.removeFile }}\"\r\n    ></i>\r\n  </ng-template>\r\n  <div *ngIf=\"file.status === 'uploading'\" class=\"ant-upload-list-item-progress\">\r\n    <nz-progress [nzPercent]=\"file.percent\" [nzShowInfo]=\"false\" [nzStrokeWidth]=\"2\"></nz-progress>\r\n  </div>\r\n</div>\r\n","<ng-template #list>\r\n  <nz-upload-list\r\n    #listComp\r\n    [style.display]=\"nzShowUploadList ? '' : 'none'\"\r\n    [locale]=\"locale\"\r\n    [listType]=\"nzListType\"\r\n    [items]=\"nzFileList || []\"\r\n    [icons]=\"nzShowUploadList\"\r\n    [onPreview]=\"nzPreview\"\r\n    [onRemove]=\"onRemove\"\r\n  ></nz-upload-list>\r\n</ng-template>\r\n<ng-template #con><ng-content></ng-content></ng-template>\r\n<ng-template #btn>\r\n  <div [ngClass]=\"classList\" [style.display]=\"nzShowButton ? '' : 'none'\">\r\n    <div nz-upload-btn #uploadComp [options]=\"_btnOptions\">\r\n      <ng-template [ngTemplateOutlet]=\"con\"></ng-template>\r\n    </div>\r\n  </div>\r\n</ng-template>\r\n<ng-container *ngIf=\"nzType === 'drag'; else select\">\r\n  <div\r\n    [ngClass]=\"classList\"\r\n    (drop)=\"fileDrop($event)\"\r\n    (dragover)=\"fileDrop($event)\"\r\n    (dragleave)=\"fileDrop($event)\"\r\n  >\r\n    <div nz-upload-btn #uploadComp [options]=\"_btnOptions\" [classes]=\"{ 'ant-upload-btn': true }\">\r\n      <div class=\"ant-upload-drag-container\">\r\n        <ng-template [ngTemplateOutlet]=\"con\"></ng-template>\r\n      </div>\r\n    </div>\r\n  </div>\r\n  <ng-template [ngTemplateOutlet]=\"list\"></ng-template>\r\n</ng-container>\r\n<ng-template #select>\r\n  <ng-container *ngIf=\"nzListType === 'picture-card'; else pic\">\r\n    <ng-template [ngTemplateOutlet]=\"list\"></ng-template>\r\n    <ng-template [ngTemplateOutlet]=\"btn\"></ng-template>\r\n  </ng-container>\r\n</ng-template>\r\n<ng-template #pic>\r\n  <ng-template [ngTemplateOutlet]=\"btn\"></ng-template>\r\n  <ng-template [ngTemplateOutlet]=\"list\"></ng-template>\r\n</ng-template>\r\n","/**\r\n * @license\r\n * Copyright Alibaba.com All Rights Reserved.\r\n *\r\n * Use of this source code is governed by an MIT-style license that can be\r\n * found in the LICENSE file at https://github.com/NG-ZORRO/ng-zorro-antd/blob/master/LICENSE\r\n */\r\n\r\nimport {\r\n  ChangeDetectionStrategy,\r\n  ChangeDetectorRef,\r\n  Component,\r\n  EventEmitter,\r\n  Input,\r\n  OnChanges,\r\n  OnDestroy,\r\n  OnInit,\r\n  Output,\r\n  SimpleChange,\r\n  SimpleChanges,\r\n  ViewChild,\r\n  ViewEncapsulation\r\n} from '@angular/core';\r\nimport { Observable, of, Subscription } from 'rxjs';\r\nimport { filter } from 'rxjs/operators';\r\n\r\nimport { InputBoolean, InputNumber, toBoolean } from 'ng-zorro-antd/core';\r\nimport { NzI18nService } from 'ng-zorro-antd/i18n';\r\n\r\nimport {\r\n  ShowUploadListInterface,\r\n  UploadChangeParam,\r\n  UploadFile,\r\n  UploadFilter,\r\n  UploadListType,\r\n  UploadType,\r\n  UploadXHRArgs,\r\n  ZipButtonOptions\r\n} from './interface';\r\nimport { NzUploadBtnComponent } from './nz-upload-btn.component';\r\nimport { NzUploadListComponent } from './nz-upload-list.component';\r\n\r\n@Component({\r\n  selector: 'nz-upload',\r\n  exportAs: 'nzUpload',\r\n  templateUrl: './nz-upload.component.html',\r\n  preserveWhitespaces: false,\r\n  encapsulation: ViewEncapsulation.None,\r\n  changeDetection: ChangeDetectionStrategy.OnPush,\r\n  host: {\r\n    '[class.ant-upload-picture-card-wrapper]': 'nzListType === \"picture-card\"'\r\n  }\r\n})\r\nexport class NzUploadComponent implements OnInit, OnChanges, OnDestroy {\r\n  private i18n$: Subscription;\r\n  @ViewChild('uploadComp', { static: false }) uploadComp: NzUploadBtnComponent;\r\n  @ViewChild('listComp', { static: false }) listComp: NzUploadListComponent;\r\n  // tslint:disable-next-line:no-any\r\n  locale: any = {};\r\n\r\n  // #region fields\r\n\r\n  @Input() nzType: UploadType = 'select';\r\n  @Input() @InputNumber() nzLimit = 0;\r\n  @Input() @InputNumber() nzSize = 0;\r\n\r\n  @Input() nzFileType: string;\r\n  @Input() nzAccept: string | string[];\r\n  @Input() nzAction: string;\r\n  @Input() @InputBoolean() nzDirectory = false;\r\n  @Input() @InputBoolean() nzOpenFileDialogOnClick = true;\r\n  @Input() nzBeforeUpload: (file: UploadFile, fileList: UploadFile[]) => boolean | Observable<boolean>;\r\n  @Input() nzCustomRequest: (item: UploadXHRArgs) => Subscription;\r\n  @Input() nzData: {} | ((file: UploadFile) => {});\r\n  @Input() nzFilter: UploadFilter[] = [];\r\n  @Input() nzFileList: UploadFile[] = [];\r\n  @Input() @InputBoolean() nzDisabled = false;\r\n  @Input() nzHeaders: {} | ((file: UploadFile) => {});\r\n  @Input() nzListType: UploadListType = 'text';\r\n  @Input() @InputBoolean() nzMultiple = false;\r\n  @Input() nzName = 'file';\r\n\r\n  private _showUploadList: boolean | ShowUploadListInterface = true;\r\n\r\n  @Input()\r\n  set nzShowUploadList(value: boolean | ShowUploadListInterface) {\r\n    this._showUploadList = typeof value === 'boolean' ? toBoolean(value) : value;\r\n  }\r\n\r\n  get nzShowUploadList(): boolean | ShowUploadListInterface {\r\n    return this._showUploadList;\r\n  }\r\n\r\n  @Input() @InputBoolean() nzShowButton = true;\r\n  @Input() @InputBoolean() nzWithCredentials = false;\r\n\r\n  @Input() nzRemove: (file: UploadFile) => boolean | Observable<boolean>;\r\n  @Input() nzPreview: (file: UploadFile) => void;\r\n\r\n  @Output() readonly nzChange: EventEmitter<UploadChangeParam> = new EventEmitter<UploadChangeParam>();\r\n  @Output() readonly nzFileListChange: EventEmitter<UploadFile[]> = new EventEmitter<UploadFile[]>();\r\n\r\n  _btnOptions: ZipButtonOptions;\r\n\r\n  private zipOptions(): this {\r\n    if (typeof this.nzShowUploadList === 'boolean' && this.nzShowUploadList) {\r\n      this.nzShowUploadList = {\r\n        showPreviewIcon: true,\r\n        showRemoveIcon: true,\r\n        hidePreviewIconInNonImage: false\r\n      };\r\n    }\r\n    // filters\r\n    const filters: UploadFilter[] = this.nzFilter.slice();\r\n    if (this.nzMultiple && this.nzLimit > 0 && filters.findIndex(w => w.name === 'limit') === -1) {\r\n      filters.push({\r\n        name: 'limit',\r\n        fn: (fileList: UploadFile[]) => fileList.slice(-this.nzLimit)\r\n      });\r\n    }\r\n    if (this.nzSize > 0 && filters.findIndex(w => w.name === 'size') === -1) {\r\n      filters.push({\r\n        name: 'size',\r\n        fn: (fileList: UploadFile[]) => fileList.filter(w => w.size / 1024 <= this.nzSize)\r\n      });\r\n    }\r\n    if (this.nzFileType && this.nzFileType.length > 0 && filters.findIndex(w => w.name === 'type') === -1) {\r\n      const types = this.nzFileType.split(',');\r\n      filters.push({\r\n        name: 'type',\r\n        fn: (fileList: UploadFile[]) => fileList.filter(w => ~types.indexOf(w.type))\r\n      });\r\n    }\r\n    this._btnOptions = {\r\n      disabled: this.nzDisabled,\r\n      accept: this.nzAccept,\r\n      action: this.nzAction,\r\n      directory: this.nzDirectory,\r\n      openFileDialogOnClick: this.nzOpenFileDialogOnClick,\r\n      beforeUpload: this.nzBeforeUpload,\r\n      customRequest: this.nzCustomRequest,\r\n      data: this.nzData,\r\n      headers: this.nzHeaders,\r\n      name: this.nzName,\r\n      multiple: this.nzMultiple,\r\n      withCredentials: this.nzWithCredentials,\r\n      filters,\r\n      onStart: this.onStart,\r\n      onProgress: this.onProgress,\r\n      onSuccess: this.onSuccess,\r\n      onError: this.onError\r\n    };\r\n    return this;\r\n  }\r\n\r\n  // #endregion\r\n\r\n  constructor(private cdr: ChangeDetectorRef, private i18n: NzI18nService) {}\r\n\r\n  // #region upload\r\n\r\n  private fileToObject(file: UploadFile): UploadFile {\r\n    return {\r\n      lastModified: file.lastModified,\r\n      lastModifiedDate: file.lastModifiedDate,\r\n      name: file.filename || file.name,\r\n      size: file.size,\r\n      type: file.type,\r\n      uid: file.uid,\r\n      response: file.response,\r\n      error: file.error,\r\n      percent: 0,\r\n      // tslint:disable-next-line:no-any\r\n      originFileObj: file as any\r\n    };\r\n  }\r\n\r\n  private getFileItem(file: UploadFile, fileList: UploadFile[]): UploadFile {\r\n    return fileList.filter(item => item.uid === file.uid)[0];\r\n  }\r\n\r\n  private removeFileItem(file: UploadFile, fileList: UploadFile[]): UploadFile[] {\r\n    return fileList.filter(item => item.uid !== file.uid);\r\n  }\r\n\r\n  private genErr(file: UploadFile): string {\r\n    return file.response && typeof file.response === 'string'\r\n      ? file.response\r\n      : (file.error && file.error.statusText) || this.locale.uploadError;\r\n  }\r\n\r\n  private onStart = (file: UploadFile): void => {\r\n    if (!this.nzFileList) {\r\n      this.nzFileList = [];\r\n    }\r\n    const targetItem = this.fileToObject(file);\r\n    targetItem.status = 'uploading';\r\n    this.nzFileList = this.nzFileList.concat(targetItem);\r\n    this.nzFileListChange.emit(this.nzFileList);\r\n    this.nzChange.emit({ file: targetItem, fileList: this.nzFileList, type: 'start' });\r\n    this.detectChangesList();\r\n  };\r\n\r\n  private onProgress = (e: { percent: number }, file: UploadFile): void => {\r\n    const fileList = this.nzFileList;\r\n    const targetItem = this.getFileItem(file, fileList);\r\n    targetItem.percent = e.percent;\r\n    this.nzChange.emit({\r\n      event: e,\r\n      file: { ...targetItem },\r\n      fileList: this.nzFileList,\r\n      type: 'progress'\r\n    });\r\n    this.detectChangesList();\r\n  };\r\n\r\n  private onSuccess = (res: {}, file: UploadFile): void => {\r\n    const fileList = this.nzFileList;\r\n    const targetItem = this.getFileItem(file, fileList);\r\n    targetItem.status = 'done';\r\n    targetItem.response = res;\r\n    this.nzChange.emit({\r\n      file: { ...targetItem },\r\n      fileList,\r\n      type: 'success'\r\n    });\r\n    this.detectChangesList();\r\n  };\r\n\r\n  private onError = (err: {}, file: UploadFile): void => {\r\n    const fileList = this.nzFileList;\r\n    const targetItem = this.getFileItem(file, fileList);\r\n    targetItem.error = err;\r\n    targetItem.status = 'error';\r\n    targetItem.message = this.genErr(targetItem);\r\n    this.nzChange.emit({\r\n      file: { ...targetItem },\r\n      fileList,\r\n      type: 'error'\r\n    });\r\n    this.detectChangesList();\r\n  };\r\n\r\n  // #endregion\r\n\r\n  // #region drag\r\n\r\n  private dragState: string;\r\n\r\n  // skip safari bug\r\n  // tslint:disable-next-line:no-any\r\n  fileDrop(e: any): void {\r\n    if (e.type === this.dragState) {\r\n      return;\r\n    }\r\n    this.dragState = e.type;\r\n    this.setClassMap();\r\n  }\r\n\r\n  // #endregion\r\n\r\n  // #region list\r\n\r\n  private detectChangesList(): void {\r\n    this.cdr.detectChanges();\r\n    this.listComp.detectChanges();\r\n  }\r\n\r\n  onRemove = (file: UploadFile): void => {\r\n    this.uploadComp.abort(file);\r\n    file.status = 'removed';\r\n    const fnRes = typeof this.nzRemove === 'function' ? this.nzRemove(file) : this.nzRemove == null ? true : this.nzRemove;\r\n    (fnRes instanceof Observable ? fnRes : of(fnRes)).pipe(filter((res: boolean) => res)).subscribe(() => {\r\n      this.nzFileList = this.removeFileItem(file, this.nzFileList);\r\n      this.nzChange.emit({\r\n        file,\r\n        fileList: this.nzFileList,\r\n        type: 'removed'\r\n      });\r\n      this.nzFileListChange.emit(this.nzFileList);\r\n      this.cdr.detectChanges();\r\n    });\r\n  };\r\n\r\n  // #endregion\r\n\r\n  // #region styles\r\n\r\n  private prefixCls = 'ant-upload';\r\n  classList: string[] = [];\r\n\r\n  private setClassMap(): void {\r\n    let subCls: string[] = [];\r\n    if (this.nzType === 'drag') {\r\n      if (this.nzFileList.some(file => file.status === 'uploading')) {\r\n        subCls.push(`${this.prefixCls}-drag-uploading`);\r\n      }\r\n      if (this.dragState === 'dragover') {\r\n        subCls.push(`${this.prefixCls}-drag-hover`);\r\n      }\r\n    } else {\r\n      subCls = [`${this.prefixCls}-select-${this.nzListType}`];\r\n    }\r\n\r\n    this.classList = [\r\n      this.prefixCls,\r\n      `${this.prefixCls}-${this.nzType}`,\r\n      ...subCls,\r\n      (this.nzDisabled && `${this.prefixCls}-disabled`) || ''\r\n    ].filter(item => !!item);\r\n\r\n    this.cdr.detectChanges();\r\n  }\r\n\r\n  // #endregion\r\n\r\n  ngOnInit(): void {\r\n    this.i18n$ = this.i18n.localeChange.subscribe(() => {\r\n      this.locale = this.i18n.getLocaleData('Upload');\r\n      this.detectChangesList();\r\n    });\r\n  }\r\n\r\n  ngOnChanges(changes: { [P in keyof this]?: SimpleChange } & SimpleChanges): void {\r\n    if (changes.nzFileList) {\r\n      (this.nzFileList || []).forEach(file => (file.message = this.genErr(file)));\r\n    }\r\n    this.zipOptions().setClassMap();\r\n  }\r\n\r\n  ngOnDestroy(): void {\r\n    this.i18n$.unsubscribe();\r\n  }\r\n}\r\n","/**\r\n * @license\r\n * Copyright Alibaba.com All Rights Reserved.\r\n *\r\n * Use of this source code is governed by an MIT-style license that can be\r\n * found in the LICENSE file at https://github.com/NG-ZORRO/ng-zorro-antd/blob/master/LICENSE\r\n */\r\nimport { PlatformModule } from '@angular/cdk/platform';\r\nimport { CommonModule } from '@angular/common';\r\nimport { NgModule } from '@angular/core';\r\nimport { FormsModule } from '@angular/forms';\r\nimport { NzI18nModule } from 'ng-zorro-antd/i18n';\r\nimport { NzIconModule } from 'ng-zorro-antd/icon';\r\nimport { NzProgressModule } from 'ng-zorro-antd/progress';\r\nimport { NzToolTipModule } from 'ng-zorro-antd/tooltip';\r\n\r\nimport { NzUploadBtnComponent } from './nz-upload-btn.component';\r\nimport { NzUploadListComponent } from './nz-upload-list.component';\r\nimport { NzUploadComponent } from './nz-upload.component';\r\n\r\n@NgModule({\r\n  imports: [CommonModule, FormsModule, PlatformModule, NzToolTipModule, NzProgressModule, NzI18nModule, NzIconModule],\r\n  declarations: [NzUploadComponent, NzUploadBtnComponent, NzUploadListComponent],\r\n  exports: [NzUploadComponent]\r\n})\r\nexport class NzUploadModule {}\r\n"]}