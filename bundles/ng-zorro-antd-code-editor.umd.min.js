!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@angular/core"),require("@angular/forms"),require("rxjs"),require("rxjs/operators"),require("ng-zorro-antd/core"),require("@angular/common"),require("ng-zorro-antd/spin"),require("ng-zorro-antd/icon")):"function"==typeof define&&define.amd?define("ng-zorro-antd/code-editor",["exports","@angular/core","@angular/forms","rxjs","rxjs/operators","ng-zorro-antd/core","@angular/common","ng-zorro-antd/spin","ng-zorro-antd/icon"],e):e(((t=t||self)["ng-zorro-antd"]=t["ng-zorro-antd"]||{},t["ng-zorro-antd"]["code-editor"]={}),t.ng.core,t.ng.forms,t.rxjs,t.rxjs.operators,t["ng-zorro-antd"].core,t.ng.common,t["ng-zorro-antd"].spin,t["ng-zorro-antd"].icon)}(this,(function(t,e,o,n,i,r,a,d,s){"use strict";
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation. All rights reserved.
    Licensed under the Apache License, Version 2.0 (the "License"); you may not use
    this file except in compliance with the License. You may obtain a copy of the
    License at http://www.apache.org/licenses/LICENSE-2.0

    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
    MERCHANTABLITY OR NON-INFRINGEMENT.

    See the Apache Version 2.0 License for specific language governing permissions
    and limitations under the License.
    ***************************************************************************** */var c,u=function(){return(u=Object.assign||function(t){for(var e,o=1,n=arguments.length;o<n;o++)for(var i in e=arguments[o])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};function l(t,e,o,n){var i,r=arguments.length,a=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var d=t.length-1;d>=0;d--)(i=t[d])&&(a=(r<3?i(a):r>3?i(e,o,a):i(e,o))||a);return r>3&&a&&Object.defineProperty(e,o,a),a}function p(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}function f(t,e){var o="function"==typeof Symbol&&t[Symbol.iterator];if(!o)return t;var n,i,r=o.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(n=r.next()).done;)a.push(n.value)}catch(t){i={error:t}}finally{try{n&&!n.done&&(o=r.return)&&o.call(r)}finally{if(i)throw i.error}}return a}function h(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(f(arguments[e]));return t}(
/**
     * @license
     * Copyright Alibaba.com All Rights Reserved.
     *
     * Use of this source code is governed by an MIT-style license that can be
     * found in the LICENSE file at https://github.com/NG-ZORRO/ng-zorro-antd/blob/master/LICENSE
     */
c=t.NzCodeEditorLoadingStatus||(t.NzCodeEditorLoadingStatus={})).UNLOAD="unload",c.LOADING="loading",c.LOADED="LOADED";var g=new e.InjectionToken("nz-code-editor-config",{providedIn:"root",factory:m});function m(){return{}}var z="codeEditor";function v(t){return function(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];t&&t.apply(void 0,h(e))}}var O=function(){function o(e,o,i){var a=this;this.nzConfigService=e,this.firstEditorInitialized=!1,this.loaded$=new n.Subject,this.loadingStatus=t.NzCodeEditorLoadingStatus.UNLOAD,this.option$=new n.BehaviorSubject(this.option);var d=this.nzConfigService.getConfigForComponent(z);i&&r.warnDeprecation("'NZ_CODE_EDITOR_CONFIG' is deprecated and will be removed in next minor version. Please use 'NzConfigService' instead."),this.document=o,this.config=u(u({},i),d),this.option=this.config.defaultEditorOption||{},this.nzConfigService.getConfigChangeEventForComponent(z).subscribe((function(){var t=a.nzConfigService.getConfigForComponent(z);t&&a._updateDefaultOption(t.defaultEditorOption)}))}return o.prototype.updateDefaultOption=function(t){r.warnDeprecation("'updateDefaultOption' is deprecated and will be removed in next minor version. Please use 'set' of 'NzConfigService' instead."),this._updateDefaultOption(t)},o.prototype._updateDefaultOption=function(t){this.option=u(u({},this.option),t),this.option$.next(this.option),t.theme&&monaco.editor.setTheme(t.theme)},o.prototype.requestToInit=function(){var e=this;return this.loadingStatus===t.NzCodeEditorLoadingStatus.LOADED?(this.onInit(),n.of(this.getLatestOption())):(this.loadingStatus===t.NzCodeEditorLoadingStatus.UNLOAD&&(this.config.useStaticLoading&&"undefined"==typeof monaco?r.warn("You choose to use static loading but it seems that you forget to config webpack plugin correctly. Please refer to our official websitefor more details about static loading."):this.loadMonacoScript()),this.loaded$.asObservable().pipe(i.tap((function(){return e.onInit()})),i.map((function(){return e.getLatestOption()}))))},o.prototype.loadMonacoScript=function(){var e=this;if(this.config.useStaticLoading)this.onLoad();else if(this.loadingStatus!==t.NzCodeEditorLoadingStatus.LOADING){this.loadingStatus=t.NzCodeEditorLoadingStatus.LOADING;var o=this.config.assetsRoot,n=o?o+"/vs":"assets/vs",i=window,a=this.document.createElement("script");a.type="text/javascript",a.src=n+"/loader.js",a.onload=function(){i.require.config({paths:{vs:n}}),i.require(["vs/editor/editor.main"],(function(){e.onLoad()}))},a.onerror=function(){throw new Error(r.PREFIX+' cannot load assets of monaco editor from source "'+n+'".')},this.document.documentElement.appendChild(a)}},o.prototype.onLoad=function(){this.loadingStatus=t.NzCodeEditorLoadingStatus.LOADED,this.loaded$.next(!0),this.loaded$.complete(),v(this.config.onLoad)()},o.prototype.onInit=function(){this.firstEditorInitialized||(this.firstEditorInitialized=!0,v(this.config.onFirstEditorInit)()),v(this.config.onInit)()},o.prototype.getLatestOption=function(){return u({},this.option)},o.ɵfac=function(t){return new(t||o)(e.ɵɵinject(r.NzConfigService),e.ɵɵinject(a.DOCUMENT),e.ɵɵinject(g,8))},o.ɵprov=e.ɵɵdefineInjectable({token:o,factory:o.ɵfac,providedIn:"root"}),o}();function y(t,o){1&t&&(e.ɵɵelementStart(0,"div",2),e.ɵɵelement(1,"nz-spin"),e.ɵɵelementEnd())}function C(t,e){}function E(t,o){if(1&t&&(e.ɵɵelementStart(0,"div",3),e.ɵɵtemplate(1,C,0,0,"ng-template",4),e.ɵɵelementEnd()),2&t){var n=e.ɵɵnextContext();e.ɵɵadvance(1),e.ɵɵproperty("ngTemplateOutlet",n.nzToolkit)}}var I=function(){function t(t,o,i){this.nzCodeEditorService=t,this.ngZone=o,this.nzEditorMode="normal",this.nzOriginalText="",this.nzLoading=!1,this.nzFullControl=!1,this.nzEditorInitialized=new e.EventEmitter,this.editorOptionCached={},this.destroy$=new n.Subject,this.resize$=new n.Subject,this.editorOption$=new n.BehaviorSubject({}),this.value="",this.modelSet=!1,this.el=i.nativeElement}return Object.defineProperty(t.prototype,"nzEditorOption",{set:function(t){this.editorOption$.next(t)},enumerable:!0,configurable:!0}),t.prototype.ngAfterViewInit=function(){var t=this;this.nzCodeEditorService.requestToInit().subscribe((function(e){return t.setup(e)}))},t.prototype.ngOnDestroy=function(){this.editorInstance&&this.editorInstance.dispose(),this.destroy$.next(),this.destroy$.complete()},t.prototype.writeValue=function(t){this.value=t,this.setValue()},t.prototype.registerOnChange=function(t){this.onChange=t},t.prototype.registerOnTouched=function(t){this.onTouch=t},t.prototype.onChange=function(t){},t.prototype.onTouch=function(){},t.prototype.layout=function(){this.resize$.next()},t.prototype.setup=function(t){var e=this;r.inNextTick().subscribe((function(){e.editorOptionCached=t,e.registerOptionChanges(),e.initMonacoEditorInstance(),e.registerResizeChange(),e.setValue(),e.nzFullControl||e.setValueEmitter(),e.nzEditorInitialized.emit(e.editorInstance)}))},t.prototype.registerOptionChanges=function(){var t=this;n.combineLatest([this.editorOption$,this.nzCodeEditorService.option$]).pipe(i.takeUntil(this.destroy$)).subscribe((function(e){var o=f(e,2),n=o[0],i=o[1];t.editorOptionCached=u(u(u({},t.editorOptionCached),i),n),t.updateOptionToMonaco()}))},t.prototype.initMonacoEditorInstance=function(){var t=this;this.ngZone.runOutsideAngular((function(){t.editorInstance="normal"===t.nzEditorMode?monaco.editor.create(t.el,u({},t.editorOptionCached)):monaco.editor.createDiffEditor(t.el,u({},t.editorOptionCached))}))},t.prototype.registerResizeChange=function(){var t=this;this.ngZone.runOutsideAngular((function(){n.fromEvent(window,"resize").pipe(i.debounceTime(300),i.takeUntil(t.destroy$)).subscribe((function(){t.layout()})),t.resize$.pipe(i.takeUntil(t.destroy$),i.filter((function(){return!!t.editorInstance})),i.map((function(){return{width:t.el.clientWidth,height:t.el.clientHeight}})),i.distinctUntilChanged((function(t,e){return t.width===e.width&&t.height===e.height})),i.debounceTime(50)).subscribe((function(){t.editorInstance.layout()}))}))},t.prototype.setValue=function(){if(this.editorInstance)if(this.nzFullControl&&this.value)r.warn("should not set value when you are using full control mode! It would result in ambiguous data flow!");else if("normal"===this.nzEditorMode)this.modelSet?this.editorInstance.getModel().setValue(this.value):(this.editorInstance.setModel(monaco.editor.createModel(this.value,this.editorOptionCached.language)),this.modelSet=!0);else if(this.modelSet){var t=this.editorInstance.getModel();t.modified.setValue(this.value),t.original.setValue(this.nzOriginalText)}else{var e=this.editorOptionCached.language;this.editorInstance.setModel({original:monaco.editor.createModel(this.value,e),modified:monaco.editor.createModel(this.nzOriginalText,e)})}},t.prototype.setValueEmitter=function(){var t=this,e="normal"===this.nzEditorMode?this.editorInstance.getModel():this.editorInstance.getModel().modified;e.onDidChangeContent((function(){t.emitValue(e.getValue())}))},t.prototype.emitValue=function(t){this.value=t,this.onChange(t)},t.prototype.updateOptionToMonaco=function(){this.editorInstance&&this.editorInstance.updateOptions(u({},this.editorOptionCached))},t.ɵfac=function(o){return new(o||t)(e.ɵɵdirectiveInject(O),e.ɵɵdirectiveInject(e.NgZone),e.ɵɵdirectiveInject(e.ElementRef))},t.ɵcmp=e.ɵɵdefineComponent({type:t,selectors:[["nz-code-editor"]],hostBindings:function(t,o,n){1&t&&e.ɵɵallocHostVars(1),2&t&&e.ɵɵclassProp("ant-code-editor",!0)},inputs:{nzEditorMode:"nzEditorMode",nzOriginalText:"nzOriginalText",nzLoading:"nzLoading",nzFullControl:"nzFullControl",nzToolkit:"nzToolkit",nzEditorOption:"nzEditorOption"},outputs:{nzEditorInitialized:"nzEditorInitialized"},exportAs:["nzCodeEditor"],features:[e.ɵɵProvidersFeature([{provide:o.NG_VALUE_ACCESSOR,useExisting:e.forwardRef((function(){return t})),multi:!0}])],decls:2,vars:2,consts:[["class","ant-code-editor-loading",4,"ngIf"],["class","ant-code-editor-toolkit",4,"ngIf"],[1,"ant-code-editor-loading"],[1,"ant-code-editor-toolkit"],[3,"ngTemplateOutlet"]],template:function(t,o){1&t&&(e.ɵɵtemplate(0,y,2,0,"div",0),e.ɵɵtemplate(1,E,2,1,"div",1)),2&t&&(e.ɵɵproperty("ngIf",o.nzLoading),e.ɵɵadvance(1),e.ɵɵproperty("ngIf",o.nzToolkit))},directives:[a.NgIf,d.NzSpinComponent,a.NgTemplateOutlet],encapsulation:2,changeDetection:0}),l([r.InputBoolean(),p("design:type",Object)],t.prototype,"nzLoading",void 0),l([r.InputBoolean(),p("design:type",Object)],t.prototype,"nzFullControl",void 0),t}(),S=function(){function t(){}return t.ɵmod=e.ɵɵdefineNgModule({type:t}),t.ɵinj=e.ɵɵdefineInjector({factory:function(e){return new(e||t)},imports:[[a.CommonModule,s.NzIconModule,d.NzSpinModule]]}),t}();("undefined"==typeof ngJitMode||ngJitMode)&&e.ɵɵsetNgModuleScope(S,{declarations:[I],imports:[a.CommonModule,s.NzIconModule,d.NzSpinModule],exports:[I]}),t.NZ_CODE_EDITOR_CONFIG=g,t.NZ_CODE_EDITOR_CONFIG_FACTORY=m,t.NzCodeEditorComponent=I,t.NzCodeEditorModule=S,t.NzCodeEditorService=O,Object.defineProperty(t,"__esModule",{value:!0})}));
//# sourceMappingURL=ng-zorro-antd-code-editor.umd.min.js.map